Refactored the module to be more extensible.
